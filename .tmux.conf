## [ Basic options ðŸ”¤ ]
# No escape timeout.
set-option -sg escape-time 0

# Enable rendering of graphical content through tmux.
set -gq allow-passthrough on
set -ga update-environment TERM
set -ga update-environment TERM_PROGRAM

# Enable true colors and set status line colours.
set-option -g default-terminal "${TERM}"
set-option -sg terminal-overrides ",*:RGB"

# Reorder windows when one of them is deleted.
set-option -g renumber-windows on

# Window and pane indices starts at 1.
set-option -g base-index 1
set-option -g pane-base-index 1

# Use basic pane separators.
set-option -g pane-border-lines simple


## [ Built-in scrollback configurations ðŸ“œ ]
# Limit the scrollback.
set-option -g history-limit 10000

# Enable vi motions mode for scrollback.
set-option -g mode-keys vi

# Vim visual selection/yank maps.
bind-key -T copy-mode-vi "v" send -X begin-selection
bind-key -T copy-mode-vi "V" send -X select-line
bind-key -T copy-mode-vi "C-v" {
    send -X begin-selection
    send -X rectangle-toggle
}

bind-key -T copy-mode-vi "y" send -X copy-selection

# Don't exit copy mode after dragging with mouse.
unbind -T copy-mode-vi MouseDragEnd1Pane


## [ Key bindings ðŸŽ¹ ]
# Top-level mappings ðŸ†™

# Switch to a specific window.
bind-key -n "C-1" select-window -t 1
bind-key -n "C-2" select-window -t 2
bind-key -n "C-3" select-window -t 3
bind-key -n "C-4" select-window -t 4
bind-key -n "C-5" select-window -t 5
bind-key -n "C-6" select-window -t 6
bind-key -n "C-7" select-window -t 7
bind-key -n "C-8" select-window -t 8
bind-key -n "C-9" select-window -t 9
bind-key -n "C-0" select-window -t 10

# Switch to the last window.
bind-key -n "C-Tab" last-window

# Leader mappings ðŸŽ¯
# Set tmux "leader" key to Ctrl-g.
unbind C-b
set-option -g prefix C-g

# Passthrough Ctrl-g.
bind-key C-g send-keys C-g

# Window & pane mappings a la Vim: creation, splitting, switching, swapping, etc.
bind-key "n" new-window

bind-key "s" split-window -v
bind-key "v" split-window -h

bind-key "h" select-pane -L
bind-key "j" select-pane -D
bind-key "k" select-pane -U
bind-key "l" select-pane -R

bind "H" swap-pane -s '{left-of}'
bind "J" swap-pane -s '{down-of}'
bind "K" swap-pane -s '{up-of}'
bind "L" swap-pane -s '{right-of}'

bind -r "+" resize-pane -U 5
bind -r "-" resize-pane -D 5
bind -r "<" resize-pane -L 5
bind -r ">" resize-pane -R 5

bind-key "c" confirm-before -p "Kill this pane (y/n)?" "kill-pane"
bind-key "C" confirm-before -p "Kill this window (y/n)?" "kill-window"

bind-key "o" confirm-before -p "Kill all other panes (y/n)?" "kill-pane -a"
bind-key "O" confirm-before -p "Kill all other windows (y/n)?" "kill-window -a"

# [R]eload the config file.
bind-key "r" source-file ~/.tmux.conf \; display-message "Config reloaded..."

# [E]xplore the native session manager window.
bind-key "e" choose-tree -Zs

# [F]ind and open/create a session for a set of predefined working directories.
bind-key "f" run-shell "tmux new-window 'tmux-sessionizer.sh'"

# Switch to an [a]ctive session.
bind-key "a" run-shell "tmux new-window \
    'tmux switch-client -t \
    $(tmux list-sessions | sed \"s/:.*//\" | fzf --prompt=\"Select tmux session > \")'"

# Open/create a session for the current [d]irectory.
bind-key "d" run-shell "tmux new-window 'tmux-sessionizer.sh #{pane_current_path}'"

# Switch to the last session.
bind-key "Tab" switch-client -l

# [Cl]ear the screen.
bind-key "C-l" send-keys "C-l"

# [M]aximise the current pane.
bind-key "m" resize-pane -Z

# Edit the whole (allowed) scrollback history with $EDITOR.
bind-key "]" run-shell "tmux new-window \
  'tmux capture-pane -p -t #{pane_id} -S - > /tmp/tmux-capture.txt; \
  $EDITOR /tmp/tmux-capture.txt'"

# Safely e[x]it session (i.e. kill and switch).
bind-key "x" confirm-before -p "Kill `#{client_session}` session (y/n)?" \
    "run-shell \"tmux switch-client -l; if [[ \$? -ne 0 ]]; then tmux switch-client -n; fi; tmux kill-session -t '#{client_session}'\""


## [ Custom status line and styling ðŸŽ¨ ]
set-option -g status-style 'fg=black,bg=green'

set-option -g status-left-length 60
set-option -g status-left-style 'bold'
set-option -g status-left ' [#{session_name}] > '

set-option -g status-right-length 150
set-option -g status-right-style 'bold'
set-option -g status-right '#(resolve-git-branch.sh #{pane_current_path}) (whoami) @ #{host} '

set-option -g window-status-current-style 'underscore,bold'

set-option -g pane-border-style 'fg=terminal,dim'
set-option -g display-panes-colour 'default'
